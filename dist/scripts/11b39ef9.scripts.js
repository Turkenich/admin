var Utils={isHeroku:document.location.host.search("herokuapp.com")>-1,findIdInArray:function(a,b,c){"undefined"==typeof c&&(c="_id");for(var d,e=0;d=a[e];e++)if(d[c]==b)return d;return!1}},Consts={OunceToGrams:28.3495,api_root:Utils.isHeroku?"http://turkenich-api.herokuapp.com/":"http://localhost:3000/"};Array.prototype.findById=function(a,b){"undefined"==typeof b&&(b="_id");for(var c,d=0;c=this[d];d++)if(c[b]==a)return c;return{}},Array.prototype.findIndexById=function(a,b){"undefined"==typeof b&&(b="_id");for(var c,d=0;c=this[d];d++)if(c[b]==a)return d;return-1},Array.prototype.findNextById=function(a,b){"undefined"==typeof b&&(b="_id");for(var c,d={},e=0;c=this[e];e++)c[b]>a&&(!d||c[b]<d[b])&&(d=c);return d},Array.prototype.findPrevById=function(a,b){"undefined"==typeof b&&(b="_id");for(var c,d={},e=0;c=this[e];e++)c[b]<a&&(!d||c[b]>d[b])&&(d=c);return d},angular.module("adminApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap","ui.bootstrap.tpls","ui.bootstrap.transition"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl",reloadOnSearch:!1}).when("/orders",{templateUrl:"views/orders.html",controller:"OrdersCtrl",reloadOnSearch:!1}).when("/orders/:id",{templateUrl:"views/order.html",controller:"OrdersCtrl",reloadOnSearch:!1}).when("/models",{templateUrl:"views/models.html",controller:"ModelsCtrl",reloadOnSearch:!1}).when("/models/:id",{templateUrl:"views/model.html",controller:"ModelsCtrl",reloadOnSearch:!1}).when("/elements",{templateUrl:"views/elements.html",controller:"ElementsCtrl",reloadOnSearch:!1}).when("/elements/:id",{templateUrl:"views/element.html",controller:"ElementsCtrl",reloadOnSearch:!1}).when("/prices",{templateUrl:"views/prices.html",controller:"PricesCtrl",reloadOnSearch:!1}).when("/prices/:id",{templateUrl:"views/price.html",controller:"PricesCtrl",reloadOnSearch:!1}).when("/coatings",{templateUrl:"views/coatings.html",controller:"CoatingsCtrl"}).when("/coatings/:id",{templateUrl:"views/coating.html",controller:"CoatingsCtrl"}).when("/materials",{templateUrl:"views/materials.html",controller:"MaterialsCtrl"}).when("/materials/:id",{templateUrl:"views/material.html",controller:"MaterialsCtrl"}).when("/providers",{templateUrl:"views/providers.html",controller:"ProvidersCtrl"}).when("/providers/:id",{templateUrl:"views/provider.html",controller:"ProvidersCtrl"}).when("/elementFeatures",{templateUrl:"views/elementFeatures.html",controller:"ElementFeaturesCtrl"}).when("/elementFeatures/:id",{templateUrl:"views/elementFeature.html",controller:"ElementFeaturesCtrl"}).when("/elementTypes",{templateUrl:"views/elementTypes.html",controller:"ElementTypesCtrl"}).when("/elementTypes/:id",{templateUrl:"views/elementType.html",controller:"ElementTypesCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("adminApp").directive("jsonExplorer",["$http",function(a){return{restrict:"E",scope:{jsonData:"@"},link:function(a,b,c){c.$observe("jsonData",function(a){function c(a){var b=a.target,c=b.parentNode.getElementsByClassName("collapsible");if(c.length)if(c=c[0],"none"==c.style.display){var d=c.parentNode.getElementsByClassName("ellipsis")[0];c.parentNode.removeChild(d),c.style.display="",b.innerHTML="-"}else{c.style.display="none";var d=document.createElement("span");d.className="ellipsis",d.innerHTML=" &hellip; ",c.parentNode.insertBefore(d,c),b.innerHTML="+"}}var d={};d.jsString=function(a){var b,c={"\b":"b","\f":"f","\r":"r","\n":"n","	":"t"};for(b in c)-1===a.indexOf(b)&&delete c[b];a=JSON.stringify({a:a}),a=a.slice(6,-2);for(b in c)a=a.replace(new RegExp("\\\\u000"+b.charCodeAt().toString(16),"ig"),"\\"+c[b]);return this.htmlEncode(a)},d.htmlEncode=function(a){return null==a?"":a.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},d.decorateWithSpan=function(a,b){return'<span class="'+b+'">'+this.htmlEncode(a)+"</span>"},d.arrayToHtml=function(a){var b=!1,c="",d=0;for(var e in a)d++;for(var e in a)b=!0,c+="<li>"+this.valueToHtml(a[e]),d>1&&(c+=","),c+="</li>",d--;return c=b?'[<ul class="array collapsible">'+c+"</ul>]":"[ ]"},d.objectToHtml=function(a){var b=!1,c="",d=0;for(var e in a)d++;for(var e in a)b=!0,c+='<li><span class="prop"><span class="q">"</span>'+this.jsString(e)+'<span class="q">"</span></span>: '+this.valueToHtml(a[e]),d>1&&(c+=","),c+="</li>",d--;return c=b?'{<ul class="obj collapsible">'+c+"</ul>}":"{ }"},d.valueToHtml=function(a){var b=a&&a.constructor,c="";return null==a&&(c+=this.decorateWithSpan("null","null")),a&&b==Array&&(c+=this.arrayToHtml(a)),a&&b==Object&&(c+=this.objectToHtml(a)),b==Number&&(c+=this.decorateWithSpan(a,"num")),b==String&&(c+=/^(http|https|file):\/\/[^\s]+$/i.test(a)?'<a href="'+a+'"><span class="q">"</span>'+this.jsString(a)+'<span class="q">"</span></a>':'<span class="string">"'+this.jsString(a)+'"</span>'),b==Boolean&&(c+=this.decorateWithSpan(a,"bool")),c},d.jsonToHtml=function(a){return'<div class="gd-ui-json-explorer">'+this.valueToHtml(a)+"</div>"};var e=JSON.parse(a||"{}"),f=d.jsonToHtml(e);b.html(f);for(var g=angular.element(b)[0].getElementsByTagName("ul"),h=0;h<g.length;h++){var i=g[h];if(-1!=i.className.indexOf("collapsible")&&"LI"==i.parentNode.nodeName){var j=document.createElement("div");j.className="collapser",j.innerHTML="-",j.addEventListener("click",c,!1),i.parentNode.insertBefore(j,i.parentNode.firstChild)}}})}}}]),angular.module("adminApp").directive("dynamicInput",["$rootScope","$timeout",function(a,b){return{restrict:"E",scope:{type:"@",model:"=",item:"=",name:"@",desc:"@",options:"="},template:function(a){var b='<div class="form-group tile"><label for="{{id}}" class="control-label" title="{{desc}}">{{name}}</label>';switch(a.attr("type")){case"select":b+='<select class="form-control" id="{{id}}" ng-model="model" placeholder="{{desc}}" ng-options="option.name  for option in options track by option._id " ><option value="" selected>--------</option></select>';break;case"textarea":b+='<textarea class="form-control" id="{{id}}" ng-model="model" placeholder="{{desc}}"/>';break;default:b+='<input class="form-control" id="{{id}}" type="{{type}}" ng-model="model" placeholder="{{desc}}"/>'}return b},link:function(a,c,d){a.id=d.type+"_"+d.name.replace(/'/g,""),a.$watch("model",function(d,e){d&&"select"==c.attr("type")&&b(function(){angular.isObject(a.model)?a.model=a.options.findById(a.model._id):a.model=a.options.findById(a.model)})})}}}]),angular.module("adminApp").directive("dynamicFilter",["$rootScope","$timeout",function(a,b){return{restrict:"E",scope:{type:"@",model:"@",name:"@",desc:"@",options:"=",range:"@"},template:function(a){var b='<div class="form-group tile"><label for="{{id}}" class="control-label" title="{{desc}}">{{name}}</label>';switch(a.attr("type")){case"select":b+='<select class="form-control" id="{{id}}" ng-model="filter" placeholder="{{desc}}" ng-change="updateFilter()" ng-options="option.name  for option in options track by option._id " ><option value="" selected>--------</option></select>';break;case"parent":b+='<select class="form-control" id="{{id}}" ng-model="filter" placeholder="{{desc}}" ng-change="updateFilter()" ng-options="option.name  for option in options track by option._id " ><option value="" selected>--------</option></select>';break;case"textarea":b+='<textarea class="form-control" id="{{id}}" ng-model="filter" placeholder="{{desc}}" ng-change="updateFilter()"/>';break;case"date":b+='<p class="input-group"><input type="text" class="form-control ltr-datepicker" datepicker-popup="dd/MM/yy" ng-model="filter" is-open="opened" close-text="Close"  ng-change="updateFilter()" /><span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></p>';break;default:b+='<input class="form-control" id="{{id}}" type="{{type}}" placeholder="{{desc}}" ng-model="filter" ng-change="updateFilter()"/>'}return b},link:function(b,c,d){b.id=d.model.replace(/'/g,""),b.updateFilter=function(){if("parent"==b.type){if(!b.filter)return void(a.filter._id=null);a.filter._id=JSON.parse(b.filter._id)}else{var c="";c=angular.isUndefined(b.range)?"":"_"+b.range,a.filter[b.id+c]=b.filter}console.log("filter updated",a.filter)},b.open=function(a){a.preventDefault(),a.stopPropagation(),b.opened=!0},b.$watch("options",function(a,d){a&&"select"==c.attr("type")&&angular.isDefined(b.options)&&b.options[0]&&!b.model&&(b.model=b.options[0])})}}}]),angular.module("adminApp").directive("listItem",["$rootScope","$location",function(a,b){return{restrict:"E",scope:{index:"=",item:"=",path:"@",addto:"="},template:function(a){var b='<div class="media line"><a ng-href="{{link}}" ><div class="media-body">{{item.name}} {{item.desc}} <i class="fa fa-external-link"></i> </div></a><i class="fa fa-trash" ng-click="removeItem(item)"></i><i class="fa fa-arrow-up" ng-show="item.pos" ng-click="moveItemUp(item)"></i><i class="fa fa-arrow-down" ng-show="item.pos" ng-click="moveItemDown(item)"></i><hr/></div>';return b},link:function(a,b,c){switch(a.removeItem=a.$parent.removeItem,a.moveItemUp=a.$parent.moveItemUp,a.moveItemDown=a.$parent.moveItemDown,a.path){case"elements":a.parentPath="models";break;case"models":a.parentPath="orders";break;default:a.parentPath=!1}a.addto?a.link="#/"+a.parentPath+"/"+a.addto+"?addId="+a.item._id:a.link="#/"+a.path+"/"+a.item._id}}}]),angular.module("adminApp").controller("RootCtrl",["$rootScope","$scope","$sce","ElementTypes","Materials","Coatings","ElementFeatures","Providers","Prices",function(a,b,c,d,e,f,g,h,i){console.log("VERSION: 1.0"),b.updateBreadcrumbs=function(b,c,d){a.breadcrumbs=[{name:"ראשי",link:"#/"}],b&&c&&(a.breadcrumbs.push({name:b,link:"#/"+c}),d&&a.breadcrumbs.push({name:d.code||d.name||d.desc,link:"#/"+c+"/"+d._id}))},b.updateBreadcrumbs(),b.trustUrl=function(a){return c.trustAsResourceUrl(a)},a.reloadItemImp=function(a,b,c,d){c&&c._id?a.item=b.query({id:c._id},function(){angular.isFunction(d)&&d(a.item)}):a.items=b.all({},function(){angular.isFunction(d)&&d(a.items)})},a.updateItemImp=function(a,b,c,d){console.log("updating",c),b.update(c,function(a){console.log("updated",a),angular.isFunction(d)&&d(a)})},a.removeItemImp=function(a,b,c,d){if(confirm("Are You Sure???")&&(console.log("deleting",c),b.remove({id:c._id},function(){angular.isFunction(d)&&d(c)}),a.items&&a.items.length>0)){var e=a.items.findIndexById(c._id);a.items.splice(e,1)}},a.addItemImp=function(a,b,c,d){c?b.create(c,function(a){angular.isFunction(d)&&d(a)}):b.create(function(a){angular.isFunction(d)&&d(a)})},a.moveItemImp=function(b,c,d,e,f,g){if(f>0)var h=d.findNextById(e.pos,"pos");else if(0>f)var h=d.findPrevById(e.pos,"pos");if(e&&h){var i=e.pos;e.pos=h.pos,h.pos=i,a.updateItemImp(b,c,e,g),a.updateItemImp(b,c,h,g)}},b.clearForm=function(){$(".form-control").val("").text(""),a.filter={}},b.elementTypes=d.all(),b.materials=e.all(),b.providers=h.all(),b.coatings=f.all(),b.elementFeatures=g.all(),b.prices=i.all(),b.measureUnits=[{name:"גרם",_id:"gram"},{name:"סנטימטר",_id:"centimeter"},{name:"יחידה",_id:"unit"}],b.elementsCost=function(a,c){if(c&&c.length){var d=0;b.workCost=0,b.providerWorkCost=0,b.elementFeatureCost=0,b.coatingCost=0,b.materialCost=0;for(var e,f=0;e=c[f];f++){var g=(e.measureUnitWeight||0)/(1-(e.waste||0));if(b.materials){var h=b.materials.findById(e.material),i=(h.price||0)/Consts.OunceToGrams;b.materialCost+=g*e.amount*i}if(b.coatings){var j=b.coatings.findById(e.coating),k=j.measureUnit,l=j.price;"gram"==k?b.coatingCost+=g*e.amount*l:b.coatingCost+=e.amount*l||0}if(b.elementFeatures){var m=b.elementFeatures.findById(e.elementFeature),k=m.measureUnit,n=m.price||0;"gram"==k?b.elementFeatureCost+=g*e.amount*n:b.elementFeatureCost+=e.amount*n}var o=e.workUnitPrice*((b.prices.findById(e.workUnitCurrency)||{}).conversion||0),p=e.workUnit;"gram"==p?b.providerWorkCost+=g*e.amount*o:b.providerWorkCost+=e.amount*o||0}var q=a.requiredTime||0,r=b.prices.findById("TIME","code").conversion||0;return b.workCost=(r||0)*q,d=b.workCost+b.providerWorkCost+b.elementFeatureCost+b.coatingCost+b.materialCost}}}]),angular.module("adminApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("adminApp").controller("PricesCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Prices",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("מטבעות","prices",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/prices")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/prices/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/prices/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,f,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,f,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("SettingsCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Settings",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c)},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/settings")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/settings/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/settings/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,f,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,f,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("OrdersCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Elements","Models","Orders",function(a,b,c,d,e,f,g,h){a.reloadItem=function(c){b.reloadItemImp(a,h,c,function(){a.parseModelsFromDb(),a.updateBreadcrumbs("הזמנות","orders",a.item)})},a.updateItem=function(c){c.models=a.parseModelsToDb(),b.updateItemImp(a,h,c)},a.removeItem=function(c){b.removeItemImp(a,h,c,function(){d.path("/orders")})},a.addItem=function(c){b.addItemImp(a,h,null,function(a){d.path("/orders/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,h,null,function(a){d.path("/orders/"+a._id)})},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id});var i=d.search().addId;b.filter={},a.removeModel=function(b){if(console.log("deleting",b),a.models&&a.models.length>0){var c=a.models.findIndexById(b._id);a.models.splice(c,1)}a.updateItem(a.item)},a.zeroModel=function(b){if(a.models&&a.models.length>0){var c=a.models.findIndexById(b._id);a.models[c].amount=0}a.updateItem(a.item)},a.parseModelsFromDb=function(){if(a.item){a.item.models||(a.item.models="[]");var b=JSON.parse(a.item.models);i&&b.push({id:i,amount:1}),a.models=[];for(var c,e=0;c=b[e];e++)g.query({id:c.id},function(c){c.amount=b.findById(c._id,"id").amount||0,a.models.push(c),i&&a.models.length==b.length&&(a.updateItem(a.item),i=!1,d.search({addId:null})),a.models.length==b.length&&a.getOrderElements()})}},a.parseModelsToDb=function(){if(a.item&&a.item.models){for(var b,c=[],d=0;b=a.models[d];d++)c.push({id:b._id,amount:b.amount});return a.item.models=JSON.stringify(c),a.item.models}},a.getOrderElements=function(){if(a.models&&a.models.length){for(var b,c={},d=0;b=a.models[d];d++)for(var e,g=JSON.parse(b.elements),h=0;e=g[h];h++)c[e.id]||(c[e.id]=0),c[e.id]+=1;a.elements=[];for(var i in c)f.query({id:i},function(b){a.elements.push(b),a.elements.length==g.length&&a.orderCost()})}},a.updateOrderQuantities=function(){a.totalWorkTime=0;for(var b,c={},d=0;b=a.models[d];d++){a.totalWorkTime+=b.amount*(b.requiredTime||0);for(var e,f=JSON.parse(b.elements),g=0;e=f[g];g++)c[e.id]||(c[e.id]=0),c[e.id]+=b.amount*e.amount}for(var h in c){var e=a.elements.findIndexById(h);e>=0&&(a.elements[e].amount=c[h]||0)}},a.orderCost=function(){return!a.elements||!a.elements.length>0?void 0:(a.updateOrderQuantities(),a.elementsCost({requiredTime:a.totalWorkTime},a.elements))}}]),angular.module("adminApp").controller("ModelsCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Elements","Models","Orders",function(a,b,c,d,e,f,g,h){a.reloadItem=function(c){b.reloadItemImp(a,g,c,function(){a.parseElementsFromDb(),a.updateBreadcrumbs("דגמים","models",a.item)})},a.updateItem=function(c){c.elements=a.parseElementsToDb(),b.updateItemImp(a,g,c)},a.removeItem=function(c){b.removeItemImp(a,g,c,function(){d.path("/models")})},a.addItem=function(c){b.addItemImp(a,g,null,function(a){d.path("/models/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,g,null,function(a){d.path("/models/"+a._id)})},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id});var i=d.search().addId;a.addTo=d.search().addTo,b.filter={},a.removeElement=function(b){if(console.log("deleting",b),a.elements&&a.elements.length>0){var c=a.elements.findIndexById(b._id);a.elements.splice(c,1)}a.updateItem(a.item)},a.zeroElement=function(b){if(a.elements&&a.elements.length>0){var c=a.elements.findIndexById(b._id);a.elements[c].amount=0}a.updateItem(a.item)},h.all(function(b){function c(a){for(var b,c=JSON.parse(a),d=[],e=0;b=c[e];e++)d.push(b.id);return d}a.orders=[];for(var d,e=0;d=b[e];e++)if(d.models){var f={name:d.name||d.desc},g=c(d.models);g.unshift(d._id),f._id=JSON.stringify(g),a.orders.push(f)}}),a.parseElementsFromDb=function(){if(a.item){a.item.elements||(a.item.elements="[]");var b=JSON.parse(a.item.elements);i&&b.push({id:i,amount:1}),a.elements=[];for(var c,e=0;c=b[e];e++)f.query({id:c.id},function(c){c.amount=b.findById(c._id,"id").amount||0,a.elements.push(c),i&&a.elements.length==b.length&&(a.updateItem(a.item),i=!1,d.search({addId:null})),a.elements.length==b.length&&a.modelCost()})}},a.parseElementsToDb=function(){if(a.item&&a.item.elements){for(var b,c=[],d=0;b=a.elements[d];d++)c.push({id:b._id,amount:b.amount});return a.item.elements=JSON.stringify(c),a.item.elements}},a.modelCost=function(){return a.elements&&a.elements.length?a.elementsCost(a.item,a.elements):void 0}}]),angular.module("adminApp").controller("ElementsCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Models","Elements",function(a,b,c,d,e,f,g){a.reloadItem=function(c){b.reloadItemImp(a,g,c,function(){a.updateBreadcrumbs("אלמנטים","elements",a.item)})},a.updateItem=function(c){b.updateItemImp(a,g,c)},a.removeItem=function(c){b.removeItemImp(a,g,c,function(){d.path("/elements")})},a.addItem=function(c){b.addItemImp(a,g,null,function(a){d.path("/elements/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,g,null,function(a){d.path("/elements/"+a._id)})},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id}),a.addTo=d.search().addTo,b.filter={},c.id||f.all(function(b){function c(a){for(var b,c=JSON.parse(a),d=[],e=0;b=c[e];e++)d.push(b.id);return d}a.models=[];for(var d,e=0;d=b[e];e++)if(d.elements){var f={name:d.modelCode||d.desc},g=c(d.elements);g.unshift(d._id),f._id=JSON.stringify(g),a.models.push(f)}}),a.cloudinaryData={timestamp:1345719094,callback:"https://www.turkenich.herokuapp.com/cloudinary_cors.html",signature:"7ac8c757e940d95f95495aa0f1cba89ef1a8aa7a",api_key:"1234567890"},a.duplicateForTest=function(){for(var b=1e6;a.items.length<b;)a.items=a.items.concat(a.items)}}]),angular.module("adminApp").controller("CoatingsCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Coatings",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("ציפויים","coatings",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/coatings")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/coatings/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/coatings/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,Materials,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,Materials,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("MaterialsCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Materials",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("חומרים","materials",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/materials")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/materials/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/materials/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,f,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,f,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("ProvidersCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","Providers",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("ספקים","providers",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/providers")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/providers/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/providers/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,Materials,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,Materials,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("ElementFeaturesCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","ElementFeatures",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("תכונות נוספות","elementFeatures",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/elementFeatures")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/elementFeatures/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/elementFeatures/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,Materials,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,Materials,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").controller("ElementTypesCtrl",["$scope","$rootScope","$routeParams","$location","$timeout","ElementTypes",function(a,b,c,d,e,f){a.reloadItem=function(c){b.reloadItemImp(a,f,c,function(){a.updateBreadcrumbs("סוגי אלמנטים","elementTypes",a.item)})},a.updateItem=function(c){b.updateItemImp(a,f,c)},a.removeItem=function(c){b.removeItemImp(a,f,c,function(){d.path("/elementTypes")})},a.addItem=function(c){b.addItemImp(a,f,null,function(a){d.path("/elementTypes/"+a._id)})},a.duplicateItem=function(c){b.tempItem=c,b.addItemImp(a,f,null,function(a){d.path("/elementTypes/"+a._id)})},a.moveItemDown=function(c){b.moveItemImp(a,Materials,a.items,c,1)},a.moveItemUp=function(c){b.moveItemImp(a,Materials,a.items,c,-1)},b.tempItem?e(function(){a.item=b.tempItem,a.item._id=c.id,b.tempItem=null,e(function(){a.updateItem(a.item)})}):a.reloadItem({_id:c.id})}]),angular.module("adminApp").factory("Prices",["$resource",function(a){return a(Consts.api_root+"prices/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Settings",["$resource",function(a){return a(Consts.api_root+"settings/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Orders",["$resource",function(a){return a(Consts.api_root+"orders/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Models",["$resource",function(a){return a(Consts.api_root+"models/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Elements",["$resource",function(a){return a(Consts.api_root+"elements/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("ElementTypes",["$resource",function(a){return a(Consts.api_root+"elementTypes/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Materials",["$resource",function(a){return a(Consts.api_root+"materials/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Coatings",["$resource",function(a){return a(Consts.api_root+"coatings/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("Providers",["$resource",function(a){return a(Consts.api_root+"providers/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").factory("ElementFeatures",["$resource",function(a){return a(Consts.api_root+"elementFeatures/:id",{},{all:{method:"GET",params:{},isArray:!0},query:{method:"GET",params:{},isArray:!1},create:{method:"POST",params:{}},update:{method:"PUT",params:{id:"@_id"}},remove:{method:"DELETE",params:{id:"@_id"}}})}]),angular.module("adminApp").directive("itemActions",function(){return{template:'  <div class="btn-group" role="group" aria-label="..."><button class="btn btn-{{isDirty() ? \'primary\' : \'disabled\' }}" ng-click="updateItem(item)"><i class="fa fa-check"></i> שמירה</button><button class="btn btn-{{isDirty() ? \'success\' : \'disabled\' }}" ng-click="duplicateItem(item)"><i class="fa fa-plus"></i> שמירה כחדש</button><button class="btn btn-{{isDirty() ? \'default\' : \'disabled\' }}" ng-click="reloadItem(item)"><i class="fa fa-undo"></i> ביטול</button><button class="btn btn-danger" ng-click="removeItem(item)"><i class="fa fa-trash"></i> מחיקה</button></div>',restrict:"E",link:function(a,b,c){a.isDirty=function(){return $(".ng-dirty").length>0}}}}),angular.module("adminApp").filter("listFilter",["$rootScope",function(a){return function(b){function c(a,b){for(var c in b){var d=b[c];if(c.indexOf("_")>0){var e=c.split("_"),f=e[0];if(e[1])var g=e[1]}else f=c;if(!a[f])return!1;if(angular.isArray(d)){if(-1==d.indexOf(a[f]))return!1}else if(angular.isObject(d)){if(angular.isObject(a[f])){if(d._id!=a[f]._id)return!1}else if(d._id!=a[f])return!1}else if(angular.isDate(d)){var h=new Date(d),i=new Date(a[f]);if("below"==g){if(i>h)return!1}else if("above"==g){if(h>i)return!1}else if(d&&h!=i)return!1}else if(angular.isNumber(d)){if("below"==g){if(d<a[f])return!1}else if("above"==g){if(d>a[f])return!1}else if(d&&d!=a[f])return!1}else if("string"==typeof a[f]&&"string"==typeof d){var j=new RegExp(d);if(!j.test(a[f]))return!1}}return!0}if(!(b.length<=0)){for(var d,e=a.filter,f=[],g=10,h=0;(d=b[h])&&!(f.length>g);h++)c(d,e)&&f.push(d);return f}}}]);